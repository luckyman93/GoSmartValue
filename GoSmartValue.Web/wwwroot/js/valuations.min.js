function formatCurrency(n){var t=!1;return n<0&&(t=!0,n=Math.abs(n)),(t?"-BWP ":"BWP ")+parseFloat(n,10).toFixed(2).replace(/(\d)(?=(\d{3})+\.)/g,"$1,").toString()}function SetLocalities(){var n=$("#LocationName").val(),i=locationsArray.find(t=>t.name===n).id,t=[];$.get({url:`/api/locations/GetLocalities?locationId=${i}&locationName=${n}`,success:function(n){localitiesArray=n;$.each(n,function(){let n=this;t.push(n.name)});autocomplete(document.getElementById("LocalityName"),t)}})}function SetStreets(){var n=$("#LocalityName").val(),i=localitiesArray.find(t=>t.name===n).id,t=[];$.get({url:`/api/locations/GetStreets?localityId=${i}&localityName=${n}`,success:function(n){$.each(n,function(){t.push(this.name)});autocomplete(document.getElementById("StreetName"),t)}})}function autocomplete(n,t){function u(n){if(!n)return!1;f(n);i>=n.length&&(i=0);i<0&&(i=n.length-1);n[i].classList.add("autocomplete-active")}function f(n){for(var t=0;t<n.length;t++)n[t].classList.remove("autocomplete-active")}function r(t){for(var r=document.getElementsByClassName("autocomplete-items"),i=0;i<r.length;i++)t!==r[i]&&t!==n&&r[i].parentNode.removeChild(r[i])}var i;n.addEventListener("input",function(){var e,f,u,o=this.value;if(r(),!o)return!1;for(i=-1,e=document.createElement("DIV"),e.setAttribute("id",this.id+"autocomplete-list"),e.setAttribute("class","autocomplete-items"),this.parentNode.appendChild(e),u=0;u<t.length;u++)t[u].substr(0,o.length).toUpperCase()===o.toUpperCase()&&(f=document.createElement("DIV"),f.innerHTML="<strong>"+t[u].substr(0,o.length)+"<\/strong>",f.innerHTML+=t[u].substr(o.length),f.innerHTML+="<input type='hidden' value='"+t[u]+"'>",f.addEventListener("click",function(){n.value=this.getElementsByTagName("input")[0].value;r()}),e.appendChild(f))});n.addEventListener("keydown",function(n){var t=document.getElementById(this.id+"autocomplete-list");t&&(t=t.getElementsByTagName("div"));n.keyCode===40?(i++,u(t)):n.keyCode===38?(i--,u(t)):n.keyCode===13&&(n.preventDefault(),i>-1&&t&&t[i].click())});document.addEventListener("click",function(n){r(n.target)})}var ValuationRequest;$.getScript({url:"https://maps.googleapis.com/maps/api/js?key=AIzaSyCeoY8cKFVbUSyddmZL6kGiU8p3QsCHs-0&libraries=places",success:function(){}});ValuationRequest=function(){var n={LocationId:"public variable",WardId:"public variable",PlotNo:"public variable",LandUseID:"public variable",SizeUnitsTypeID:"public variable",Size:"public variable"},t=this;this.construct=function(t){$.extend(n,t)}};var locationsArray=[],localitiesArray=[],districtsArray=[];$(document).ready(function(){var n=[],t;$.ajax({url:"/api/locations/GetLocations",success:function(t){$.each(t,function(){locationsArray.push(this);n.push(this.name)})}});autocomplete(document.getElementById("LocationName"),n);t=[];$.ajax({url:"/api/locations/GetDistricts",success:function(n){$.each(n,function(){t.push(this.name)})}});autocomplete(document.getElementById("DistrictsName"),n);$("#GetValuation").on("click",function(){console.log("Get Valuation button clicked..");$.ajax({type:"post",contentType:"application/json;",dataType:"json",url:"/api/locations/GetValuation",data:JSON.stringify({LocationId:$("#Location :selected").val(),LocationName:$("#LocationName :selected").val(),LocalityId:$("#Localities :selected").val(),LocalityName:$("#LocalityName :selected").val(),StreetName:$("#StreetName").val(),PlotNo:$("#PlotNo").val(),PropertyType:$("#PropertyType :selected").val(),LandUse:$("#LandUse :selected").val(),Size:$("#Size").val(),PurchasePrice:$("#PurchasePrice").val()||0,PurchaseDate:new Date($("#PurchasePrice").val(),1)}),success:function(n){console.log("successful call to GetValuations..");$("#ValuationReference").text(n.referenceNumber);$("#ValuationEstimatedValue").text(formatCurrency(n.estimatedValue));$("#ValuationRequest").hide();$("#ValuationResultfieldSet").show()}})});$("#GetFullReport").on("click",function(){const n=$("#ValuationReference").Text;$.ajax({type:"Post",contentType:"application/json; charset=utf-8",dataType:"json",url:"/user/locations/GetFullReport",data:JSON.stringify({Reference:n,PropertyDetailsId:$("#PropertyDetailsId").Text,EstimatedValue:$("#EstimatedValue").Text})})})});